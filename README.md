# TOEIC Part7 自動問題配信・採点・フィードバックシステム（Google Apps Script）

## プロジェクトの目的

このGoogle Apps Scriptプロジェクトは、TOEIC Part7形式の長文読解問題を自動生成し、Googleフォームを通じて受験者に配信、回答を自動採点し、AI（Gemini）による個別フィードバックをメールで返送する仕組みを提供します。

- 問題文・設問・選択肢をAIで自動生成し、メールで配信
- Googleフォームで受験者が回答
- 回答内容を自動採点し、Geminiによる詳細な解説・アドバイスを自動生成
- 採点結果とフィードバックをメールで自動送信

---

## セットアップ手順

### 1. Google スプレッドシートの準備

1. 新規スプレッドシートを作成し、以下のシートを追加してください（シート名は正確に）:

   - `setting`  
     - B1セル: Gemini APIキー  
     - B2セル: GoogleフォームID（フォーム作成後に取得）

   - `mail`  
     - B列: 配信先メールアドレス（2行目以降に1行1アドレス）

   - `answers`  
     - 問題配信ごとに、A列: 日時、B列以降: 正解（A/B/C/D）

   - `forms`  
     - 問題配信ごとに、A列: 日時、B列: 問題文、C列: 設問＋選択肢

   - `userAnswers`  
     - 回答内容の記録用（運用に応じて）

---

### 2. Googleフォームの準備

1. 新規Googleフォームを作成
2. 設問例（3問の場合）:
   - Q1: 設問1（ラジオボタン A/B/C/D）
   - Q2: 設問2（ラジオボタン A/B/C/D）
   - Q3: 設問3（ラジオボタン A/B/C/D）
3. フォームのIDを取得し、`setting`シートのB2セルに貼り付け

---

### 3. Apps Scriptのセットアップ

1. スプレッドシートの「拡張機能」→「Apps Script」を開く
2. このリポジトリの`code.js`と`appsscript.json`をプロジェクトに追加
3. 必要に応じて`test.js`はローカルテスト用として利用（Git管理対象外）

---

### 4. トリガーの設定

- `onFormSubmit`関数を「フォーム送信時」トリガーに設定  
  （Apps Scriptエディタの「トリガー」→「トリガーを追加」→「onFormSubmit」→「フォーム送信時」）

---

### 5. Gemini APIキーの取得

- Google AI Studio等でGemini APIキーを取得し、`setting`シートのB1セルに貼り付け

---

## 運用フロー

1. `sendGeminiPromptAndWriteToForm(8, 3)` を実行すると、AIが問題を生成し、メールで配信
2. 受験者はメール内リンクからGoogleフォームで回答
3. 回答送信時に自動で採点・Geminiによるフィードバックが生成され、メールで返送される

---

## 注意事項

- メール配信先は`mail`シートのB列に記載したアドレスになります
- フォームにメールアドレス欄を設けていない場合、個別返信はできません（全員同じアドレスに送信）
- 複数人・複数回運用時は、問題・回答の紐付けに注意してください
- Gemini APIの利用にはAPIキーと利用制限があります

---

## ライセンス

MIT License